Самописная тестовая задача
Мини-система страхования автомобилей

Контекст:
Нужно реализовать API для страховой компании.
Клиенты могут оформлять страховки на свои автомобили.
У полиса есть срок действия и сумма покрытия.

Требования
Модели

Customer
full_name — ФИО клиента
email (уникальный)
phone

Car
customer → Customer (FK)
vin — VIN-номер (уникальный)
model
year

InsurancePolicy
car → Car (FK)
policy_number — уникальный номер полиса
coverage_amount — сумма покрытия (например, 1 000 000 сом)
premium — стоимость страховки для клиента (считается автоматически)
start_date
end_date
status — (активен / истёк / отменён)

Бизнес-логика

Расчёт премии
    Стоимость страховки (premium) считается при создании полиса по формуле:
        premium = coverage_amount * коэффициент

    Коэффициент зависит от возраста машины:
        если машине ≤ 3 лет → 0.05
        если машине 4–10 лет → 0.08
        если > 10 лет → 0.12

Ограничения
    У одной машины не может быть более одного активного полиса.
    Если текущая дата > end_date, статус полиса автоматически становится expired.
    Пользователь может отменить активный полис (status → cancelled).

Функционал API
    Создать клиента и добавить машину.
    Создать страховку для машины (с расчётом премии).
    Получить список всех полисов клиента.
    Проверить, активен ли полис для конкретной машины.
    Отменить полис.

Доп. Условия (чтобы было не совсем CRUD)
    Сделать отдельный эндпоинт GET /policies/active/ → возвращает все активные полисы.
    Сделать эндпоинт GET /customers/<id>/summary/ → показывает:
    сколько у клиента машин
    сколько активных полисов
    общая сумма покрытия по активным полисам